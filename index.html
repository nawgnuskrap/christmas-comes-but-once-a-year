<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRISTMAS COMES BUT ONCE A YEAR</title>
    <style>
        body { 
            background-color: #ffffff; 
            color: #000000; 
            font-family: 'Courier New', Courier, monospace; 
            margin: 0; 
            padding: 0;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh;
        }
        #content-wrapper {
            width: 90%; 
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        #main-frame { 
            width: 100%; 
            height: auto; 
            display: block;
            margin: 0 auto;
        }
        #info-container { 
            margin-top: 5vh; 
            font-size: 14px; 
            line-height: 1.6;
            color: #000000;
        }
        @media (max-width: 600px) {
            #info-container { font-size: 11px; }
        }
    </style>
</head>
<body>

    <div id="content-wrapper">
        <img id="main-frame" src="" alt="Loading Frame...">
        <div id="info-container">
            <div id="frame-index"></div>
            <div id="active-duration"></div>
        </div>
    </div>

    <script>
        const TOTAL_FRAMES = 11920;
        const SEC_PER_YEAR = 31536000; // 365일 기준
        const SEC_PER_FRAME = SEC_PER_YEAR / TOTAL_FRAMES;

        function updateArchive() {
            const now = new Date(); // 1. 접속한 기기의 현지 시각을 읽어옴

            // 2. 현지 시각 기준으로 매년 12/26 00:00를 시작점으로 설정
            const currentYear = now.getFullYear();
            // 현재가 12/26 이전이면 작년 12/26을, 이후면 올해 12/26을 시작점으로 함
            const isAfterChristmas = (now.getMonth() === 11 && now.getDate() >= 26);
            const startYear = isAfterChristmas ? currentYear : currentYear - 1;
            
            // 현지 시간대의 12월 26일 0시 0분 0초
            const localStart = new Date(startYear, 11, 26, 0, 0, 0);

            // 3. 경과 시간 계산 (초 단위)
            const elapsed = (now.getTime() - localStart.getTime()) / 1000;
            
            // 4. 현재 프레임 인덱스 계산 (1~11,920)
            const frameIdx = Math.floor((elapsed % SEC_PER_YEAR) / SEC_PER_FRAME) + 1;

            // 5. 이미지 업데이트
            const imgNum = String(frameIdx).padStart(5, '0');
            document.getElementById('main-frame').src = `web_frames/${imgNum}.jpg`;

            // 6. 텍스트 업데이트 (현지 시간대 기준)
            const frameStart = new Date(localStart.getTime() + (frameIdx - 1) * SEC_PER_FRAME * 1000);
            const frameEnd = new Date(localStart.getTime() + frameIdx * SEC_PER_FRAME * 1000);

            document.getElementById('frame-index').innerText = `Frame Index : ${frameIdx.toLocaleString()} / ${TOTAL_FRAMES.toLocaleString()}`;
            
            const dateOptions = { month: 'short', day: '2-digit', year: 'numeric' };
            const dateStr = frameStart.toLocaleDateString('en-US', dateOptions);
            const startTimeStr = frameStart.toLocaleTimeString('en-GB', { hour12: false });
            const endTimeStr = frameEnd.toLocaleTimeString('en-GB', { hour12: false });

            document.getElementById('active-duration').innerText = `Active Duration : ${startTimeStr} – ${endTimeStr}, ${dateStr}`;
        }

        updateArchive();
        setInterval(updateArchive, 10000); // 10초마다 갱신 체크
    </script>
</body>
</html>
